<h4>Locations</h4>
<div id="map"></div>

<script type="text/javascript" charset="utf-8">
    $(document).ready(function () {
        var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
                osmAttrib='Map data Â© OpenStreetMap contributors',
                osm = L.tileLayer(osmUrl, {minZoom: 6, maxZoom: 18, attribution: osmAttrib});

        var map = L.map('map', {
            center: new L.LatLng(11.995840, 8.549367),
            zoom: 8,
            minZoom: 6,
            maxZoom: 18
        });

        L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
			maxZoom: 18,
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
		}).addTo(map);

        var sensor_docs = $('[ng-controller="HomeCtrl"]').scope().sensors.rows;

        $.each(sensor_docs, function(k,v) {
            var location = v.doc.location;
            var sensor_tag = v.doc.sensor_tag;
            var sensor_sn = v.doc.sensor_sn;
            var logger_sn = v.doc.logger_sn;
            var gps_s = v.doc.gps;
            var gps_spl = gps_s.split(',');

            L.marker([parseFloat(gps_spl[0]), parseFloat(gps_spl[1])]).addTo(map)
                    .bindPopup("<b><a href=\'#/data/"+logger_sn+"\'>"+sensor_tag+": "+location+"</a></b><br />("+logger_sn+":"+sensor_sn+")").openPopup();
        });

    });

</script>
